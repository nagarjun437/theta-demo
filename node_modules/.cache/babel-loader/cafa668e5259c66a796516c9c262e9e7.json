{"ast":null,"code":"var _jsxFileName = \"/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/src/app/views/app/calendar/AppCalendar.jsx\";\nimport React, { Component } from \"react\";\nimport { Breadcrumb } from \"@gull\";\nimport FullCalendar from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport timeGridPlugin from \"@fullcalendar/timegrid\";\nimport interactionPlugin, { Draggable } from \"@fullcalendar/interaction\"; // needed for dayClick\n\nimport { getAllEvents, addNewEvent, updateEvent, deleteEvent } from \"./CalendarService\";\nimport shortid from \"shortid\";\nimport CalendarEventDialog from \"./CalendarEventDialog\";\n\nclass AppCalendar extends Component {\n  constructor(...args) {\n    super(...args);\n    this.calendarComponentRef = React.createRef();\n    this.externalEventRef = React.createRef();\n    this.state = {\n      eventDialogOpen: false,\n      calendarEvents: [],\n      eventObject: {},\n      newEventInput: \"\",\n      deleteEventOnDrop: false,\n      externalEvents: [{\n        title: \"Hello world\"\n      }, {\n        title: \"Payment schedule\"\n      }, {\n        title: \"Go to shopping\"\n      }, {\n        title: \"Rend due\"\n      }, {\n        title: \"Car rent\"\n      }]\n    };\n\n    this.toggleWeekends = () => {\n      this.setState({\n        calendarWeekends: !this.state.calendarWeekends\n      });\n    };\n\n    this.gotoPast = () => {\n      let calendarApi = this.calendarComponentRef.current.getApi();\n      calendarApi.gotoDate(\"2000-01-01\"); // call a method on the Calendar object\n    };\n\n    this.handleDateClick = arg => {\n      this.setState({\n        eventDialogOpen: true,\n        eventObject: {\n          title: \"\",\n          start: arg.date,\n          allDay: arg.allDay,\n          classNames: [\"text-white\"]\n        }\n      });\n    };\n\n    this.handleEventDrop = async ({\n      event: {\n        id,\n        start,\n        end,\n        title,\n        allDay,\n        classNames,\n        backgroundColor,\n        extendedProps\n      }\n    }) => {\n      let {\n        data: eventList\n      } = await updateEvent({\n        id,\n        start,\n        end,\n        title,\n        allDay,\n        classNames,\n        color: backgroundColor\n      });\n      this.refreshFullCalendar(eventList);\n    };\n\n    this.handleExternalEventDrop = event => {\n      let {\n        date: start,\n        allDay,\n        draggedEl: {\n          innerText: title,\n          classList: {\n            value: classNames\n          }\n        }\n      } = event;\n      this.handleEventDialogSubmit({\n        start,\n        title,\n        allDay,\n        classNames: classNames.concat(\" text-white\")\n      });\n      let {\n        externalEvents = [],\n        deleteEventOnDrop\n      } = this.state;\n      if (!deleteEventOnDrop) return;\n      this.setState({\n        externalEvents: externalEvents.filter(item => !item.title.match(title))\n      });\n    };\n\n    this.handleDeleteEvent = async id => {\n      if (!id) return;\n      let {\n        data: eventList\n      } = await deleteEvent({\n        id\n      });\n      this.refreshFullCalendar(eventList);\n    };\n\n    this.toggleEventDialog = () => {\n      this.setState({\n        eventDialogOpen: !this.state.eventDialogOpen\n      });\n    };\n\n    this.handleEventDialogSubmit = async eventObject => {\n      let eventList = [];\n\n      if (eventObject.id) {\n        let {\n          data\n        } = await updateEvent(eventObject);\n        eventList = data;\n      } else {\n        let {\n          data\n        } = await addNewEvent(eventObject);\n        eventList = data;\n      }\n\n      this.refreshFullCalendar(eventList);\n    };\n\n    this.handleEventClick = ({\n      event: {\n        id,\n        start,\n        end,\n        title,\n        allDay,\n        classNames,\n        backgroundColor,\n        extendedProps\n      }\n    }) => {\n      this.setState({\n        eventDialogOpen: true,\n        eventObject: {\n          id,\n          title,\n          start,\n          end,\n          allDay,\n          classNames,\n          color: backgroundColor\n        }\n      });\n    };\n\n    this.handleChange = event => {\n      let title = event.target.value;\n\n      if (event.key === \"Enter\") {\n        title = title.trim();\n\n        if (title !== \"\") {\n          this.setState({\n            externalEvents: [...this.state.externalEvents, {\n              title\n            }],\n            newEventInput: \"\"\n          });\n        }\n      } else {\n        this.setState({\n          newEventInput: title\n        });\n      }\n    };\n\n    this.refreshFullCalendar = (eventList = []) => {\n      this.setState({\n        calendarEvents: eventList.map(e => ({\n          start: e.start,\n          title: e.title,\n          id: e.id,\n          end: e.end,\n          classNames: e.classNames,\n          color: e.color,\n          allDay: e.allDay\n        })),\n        eventDialogOpen: false\n      });\n    };\n  }\n\n  componentDidMount() {\n    getAllEvents().then(({\n      data\n    }) => {\n      if (this.state) this.setState({\n        calendarEvents: data\n      });\n    });\n    let draggableEl = this.externalEventRef.current;\n    new Draggable(draggableEl, {\n      itemSelector: \".fc-event\",\n      eventData: function (eventEl) {\n        let title = eventEl.innerText;\n        let id = shortid.generate();\n        let classNames = eventEl.classList.value + \" text-white\"; // this.handleEventDialogSubmit({\n        //   event: { title, classNames, allDay: true }\n        // });\n\n        return {\n          title,\n          id,\n          classNames,\n          create: false\n        };\n      }\n    });\n  }\n\n  render() {\n    let {\n      calendarEvents,\n      calendarWeekends,\n      eventDialogOpen,\n      eventObject,\n      newEventInput,\n      deleteEventOnDrop,\n      externalEvents = []\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Breadcrumb, {\n      routeSegments: [{\n        name: \"Home\",\n        path: \"/\"\n      }, {\n        name: \"Calendar\"\n      }],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"create_event_wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"newEvent\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 21\n      }\n    }, \" Create new Event\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      name: \"newEvent\",\n      className: \"form-control\",\n      placeholder: \"new Event\",\n      value: newEventInput,\n      onChange: this.handleChange,\n      onKeyUp: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"list-group\",\n      id: \"external-events\",\n      ref: this.externalEventRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 19\n      }\n    }, externalEvents.map((event, ind) => /*#__PURE__*/React.createElement(\"li\", {\n      key: ind,\n      style: {\n        backgroundColor: \"#f5f5f5\",\n        color: \"#000000\"\n      },\n      className: \"list-group-item  fc-event\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 23\n      }\n    }, event.title))), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"checkbox checkbox-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"checkbox\",\n      name: \"agree\",\n      value: deleteEventOnDrop,\n      checked: deleteEventOnDrop,\n      onChange: e => this.setState({\n        deleteEventOnDrop: e.target.checked\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 23\n      }\n    }, \"Remove after drop\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"checkmark\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 23\n      }\n    }))))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card mb-4 o-hidden\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(FullCalendar, {\n      defaultView: \"dayGridMonth\",\n      header: {\n        left: \"prev,next today\",\n        center: \"title\",\n        right: \"dayGridMonth,timeGridWeek,timeGridDay,listWeek\"\n      },\n      themeSystem: \"bootstrap\",\n      displayEventTime: false,\n      droppable: true,\n      editable: true,\n      eventLimit: true,\n      plugins: [dayGridPlugin, timeGridPlugin, interactionPlugin],\n      ref: this.calendarComponentRef,\n      weekends: calendarWeekends,\n      events: calendarEvents,\n      dateClick: this.handleDateClick,\n      eventDrop: this.handleEventDrop,\n      eventResize: this.handleEventDrop,\n      eventClick: this.handleEventClick,\n      drop: this.handleExternalEventDrop,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 17\n      }\n    }))))), /*#__PURE__*/React.createElement(CalendarEventDialog, {\n      open: eventDialogOpen,\n      closeDialog: this.toggleEventDialog,\n      handleSubmit: this.handleEventDialogSubmit,\n      eventObject: eventObject,\n      handleDeleteEvent: this.handleDeleteEvent,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default AppCalendar;","map":{"version":3,"sources":["/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/src/app/views/app/calendar/AppCalendar.jsx"],"names":["React","Component","Breadcrumb","FullCalendar","dayGridPlugin","timeGridPlugin","interactionPlugin","Draggable","getAllEvents","addNewEvent","updateEvent","deleteEvent","shortid","CalendarEventDialog","AppCalendar","calendarComponentRef","createRef","externalEventRef","state","eventDialogOpen","calendarEvents","eventObject","newEventInput","deleteEventOnDrop","externalEvents","title","toggleWeekends","setState","calendarWeekends","gotoPast","calendarApi","current","getApi","gotoDate","handleDateClick","arg","start","date","allDay","classNames","handleEventDrop","event","id","end","backgroundColor","extendedProps","data","eventList","color","refreshFullCalendar","handleExternalEventDrop","draggedEl","innerText","classList","value","handleEventDialogSubmit","concat","filter","item","match","handleDeleteEvent","toggleEventDialog","handleEventClick","handleChange","target","key","trim","map","e","componentDidMount","then","draggableEl","itemSelector","eventData","eventEl","generate","create","render","name","path","ind","checked","left","center","right"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Breadcrumb } from \"@gull\";\nimport FullCalendar from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport timeGridPlugin from \"@fullcalendar/timegrid\";\nimport interactionPlugin, { Draggable } from \"@fullcalendar/interaction\"; // needed for dayClick\nimport {\n  getAllEvents,\n  addNewEvent,\n  updateEvent,\n  deleteEvent\n} from \"./CalendarService\";\nimport shortid from \"shortid\";\nimport CalendarEventDialog from \"./CalendarEventDialog\";\n\nclass AppCalendar extends Component {\n  calendarComponentRef = React.createRef();\n  externalEventRef = React.createRef();\n\n  state = {\n    eventDialogOpen: false,\n    calendarEvents: [],\n    eventObject: {},\n    newEventInput: \"\",\n    deleteEventOnDrop: false,\n    externalEvents: [\n      { title: \"Hello world\" },\n      { title: \"Payment schedule\" },\n      { title: \"Go to shopping\" },\n      { title: \"Rend due\" },\n      { title: \"Car rent\" }\n    ]\n  };\n\n  toggleWeekends = () => {\n    this.setState({\n      calendarWeekends: !this.state.calendarWeekends\n    });\n  };\n\n  gotoPast = () => {\n    let calendarApi = this.calendarComponentRef.current.getApi();\n    calendarApi.gotoDate(\"2000-01-01\"); // call a method on the Calendar object\n  };\n\n  handleDateClick = arg => {\n    this.setState({\n      eventDialogOpen: true,\n      eventObject: {\n        title: \"\",\n        start: arg.date,\n        allDay: arg.allDay,\n        classNames: [\"text-white\"]\n      }\n    });\n  };\n\n  handleEventDrop = async ({\n    event: {\n      id,\n      start,\n      end,\n      title,\n      allDay,\n      classNames,\n      backgroundColor,\n      extendedProps\n    }\n  }) => {\n    let { data: eventList } = await updateEvent({\n      id,\n      start,\n      end,\n      title,\n      allDay,\n      classNames,\n      color: backgroundColor\n    });\n\n    this.refreshFullCalendar(eventList);\n  };\n\n  handleExternalEventDrop = event => {\n    let {\n      date: start,\n      allDay,\n      draggedEl: {\n        innerText: title,\n        classList: { value: classNames }\n      }\n    } = event;\n\n    this.handleEventDialogSubmit({\n      start,\n      title,\n      allDay,\n      classNames: classNames.concat(\" text-white\")\n    });\n\n    let { externalEvents = [], deleteEventOnDrop } = this.state;\n\n    if (!deleteEventOnDrop) return;\n\n    this.setState({\n      externalEvents: externalEvents.filter(item => !item.title.match(title))\n    });\n  };\n\n  handleDeleteEvent = async id => {\n    if (!id) return;\n    let { data: eventList } = await deleteEvent({ id });\n    this.refreshFullCalendar(eventList);\n  };\n\n  toggleEventDialog = () => {\n    this.setState({ eventDialogOpen: !this.state.eventDialogOpen });\n  };\n\n  handleEventDialogSubmit = async eventObject => {\n    let eventList = [];\n\n    if (eventObject.id) {\n      let { data } = await updateEvent(eventObject);\n      eventList = data;\n    } else {\n      let { data } = await addNewEvent(eventObject);\n      eventList = data;\n    }\n\n    this.refreshFullCalendar(eventList);\n  };\n\n  handleEventClick = ({\n    event: {\n      id,\n      start,\n      end,\n      title,\n      allDay,\n      classNames,\n      backgroundColor,\n      extendedProps\n    }\n  }) => {\n    this.setState({\n      eventDialogOpen: true,\n      eventObject: {\n        id,\n        title,\n        start,\n        end,\n        allDay,\n        classNames,\n        color: backgroundColor\n      }\n    });\n  };\n\n  handleChange = event => {\n    let title = event.target.value;\n    if (event.key === \"Enter\") {\n      title = title.trim();\n      if (title !== \"\") {\n        this.setState({\n          externalEvents: [...this.state.externalEvents, { title }],\n          newEventInput: \"\"\n        });\n      }\n    } else {\n      this.setState({ newEventInput: title });\n    }\n  };\n\n  refreshFullCalendar = (eventList = []) => {\n    this.setState({\n      calendarEvents: eventList.map(e => ({\n        start: e.start,\n        title: e.title,\n        id: e.id,\n        end: e.end,\n        classNames: e.classNames,\n        color: e.color,\n        allDay: e.allDay\n      })),\n      eventDialogOpen: false\n    });\n  };\n\n  componentDidMount() {\n    getAllEvents().then(({ data }) => {\n      if (this.state) this.setState({ calendarEvents: data });\n    });\n\n    let draggableEl = this.externalEventRef.current;\n    new Draggable(draggableEl, {\n      itemSelector: \".fc-event\",\n      eventData: function(eventEl) {\n        let title = eventEl.innerText;\n        let id = shortid.generate();\n        let classNames = eventEl.classList.value + \" text-white\";\n        // this.handleEventDialogSubmit({\n        //   event: { title, classNames, allDay: true }\n        // });\n        return { title, id, classNames, create: false };\n      }\n    });\n  }\n\n  render() {\n    let {\n      calendarEvents,\n      calendarWeekends,\n      eventDialogOpen,\n      eventObject,\n      newEventInput,\n      deleteEventOnDrop,\n      externalEvents = []\n    } = this.state;\n\n    return (\n      <div>\n        <Breadcrumb\n          routeSegments={[{ name: \"Home\", path: \"/\" }, { name: \"Calendar\" }]}\n        ></Breadcrumb>\n\n        <div className=\"row\">\n          <div className=\"col-md-3\">\n            <div className=\"card mb-4\">\n              <div className=\"card-body\">\n                <div className=\"create_event_wrap\">\n                  <div className=\"form-group\">\n                    <label htmlFor=\"newEvent\"> Create new Event</label>\n                    <input\n                      type=\"text\"\n                      name=\"newEvent\"\n                      className=\"form-control\"\n                      placeholder=\"new Event\"\n                      value={newEventInput}\n                      onChange={this.handleChange}\n                      onKeyUp={this.handleChange}\n                    />\n                  </div>\n\n                  <ul\n                    className=\"list-group\"\n                    id=\"external-events\"\n                    ref={this.externalEventRef}\n                  >\n                    {externalEvents.map((event, ind) => (\n                      <li\n                        key={ind}\n                        style={{ backgroundColor: \"#f5f5f5\", color: \"#000000\" }}\n                        className=\"list-group-item  fc-event\"\n                      >\n                        {event.title}\n                      </li>\n                    ))}\n                  </ul>\n                  <p>\n                    <label className=\"checkbox checkbox-primary\">\n                      <input\n                        type=\"checkbox\"\n                        name=\"agree\"\n                        value={deleteEventOnDrop}\n                        checked={deleteEventOnDrop}\n                        onChange={e =>\n                          this.setState({ deleteEventOnDrop: e.target.checked })\n                        }\n                      />\n                      <span>Remove after drop</span>\n                      <span className=\"checkmark\"></span>\n                    </label>\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"col-md-9\">\n            <div className=\"card mb-4 o-hidden\">\n              <div className=\"card-body\">\n                <FullCalendar\n                  defaultView=\"dayGridMonth\"\n                  header={{\n                    left: \"prev,next today\",\n                    center: \"title\",\n                    right: \"dayGridMonth,timeGridWeek,timeGridDay,listWeek\"\n                  }}\n                  themeSystem=\"bootstrap\"\n                  displayEventTime={false}\n                  droppable={true}\n                  editable={true}\n                  eventLimit={true}\n                  plugins={[dayGridPlugin, timeGridPlugin, interactionPlugin]}\n                  ref={this.calendarComponentRef}\n                  weekends={calendarWeekends}\n                  events={calendarEvents}\n                  dateClick={this.handleDateClick}\n                  eventDrop={this.handleEventDrop}\n                  eventResize={this.handleEventDrop}\n                  eventClick={this.handleEventClick}\n                  drop={this.handleExternalEventDrop}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        <CalendarEventDialog\n          open={eventDialogOpen}\n          closeDialog={this.toggleEventDialog}\n          handleSubmit={this.handleEventDialogSubmit}\n          eventObject={eventObject}\n          handleDeleteEvent={this.handleDeleteEvent}\n        ></CalendarEventDialog>\n      </div>\n    );\n  }\n}\n\nexport default AppCalendar;\n"]},"metadata":{},"sourceType":"module"}