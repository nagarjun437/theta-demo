{"ast":null,"code":"import _toConsumableArray from\"/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{Breadcrumb}from\"@gull\";import FullCalendar from\"@fullcalendar/react\";import dayGridPlugin from\"@fullcalendar/daygrid\";import timeGridPlugin from\"@fullcalendar/timegrid\";import interactionPlugin,{Draggable}from\"@fullcalendar/interaction\";// needed for dayClick\nimport{getAllEvents,addNewEvent,updateEvent,deleteEvent}from\"./CalendarService\";import shortid from\"shortid\";import CalendarEventDialog from\"./CalendarEventDialog\";var AppCalendar=/*#__PURE__*/function(_Component){_inherits(AppCalendar,_Component);var _super=_createSuper(AppCalendar);function AppCalendar(){var _this;_classCallCheck(this,AppCalendar);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.calendarComponentRef=React.createRef();_this.externalEventRef=React.createRef();_this.state={eventDialogOpen:false,calendarEvents:[],eventObject:{},newEventInput:\"\",deleteEventOnDrop:false,externalEvents:[{title:\"Hello world\"},{title:\"Payment schedule\"},{title:\"Go to shopping\"},{title:\"Rend due\"},{title:\"Car rent\"}]};_this.toggleWeekends=function(){_this.setState({calendarWeekends:!_this.state.calendarWeekends});};_this.gotoPast=function(){var calendarApi=_this.calendarComponentRef.current.getApi();calendarApi.gotoDate(\"2000-01-01\");// call a method on the Calendar object\n};_this.handleDateClick=function(arg){_this.setState({eventDialogOpen:true,eventObject:{title:\"\",start:arg.date,allDay:arg.allDay,classNames:[\"text-white\"]}});};_this.handleEventDrop=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var _ref$event,id,start,end,title,allDay,classNames,backgroundColor,extendedProps,_yield$updateEvent,eventList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$event=_ref.event,id=_ref$event.id,start=_ref$event.start,end=_ref$event.end,title=_ref$event.title,allDay=_ref$event.allDay,classNames=_ref$event.classNames,backgroundColor=_ref$event.backgroundColor,extendedProps=_ref$event.extendedProps;_context.next=3;return updateEvent({id:id,start:start,end:end,title:title,allDay:allDay,classNames:classNames,color:backgroundColor});case 3:_yield$updateEvent=_context.sent;eventList=_yield$updateEvent.data;_this.refreshFullCalendar(eventList);case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handleExternalEventDrop=function(event){var start=event.date,allDay=event.allDay,_event$draggedEl=event.draggedEl,title=_event$draggedEl.innerText,classNames=_event$draggedEl.classList.value;_this.handleEventDialogSubmit({start:start,title:title,allDay:allDay,classNames:classNames.concat(\" text-white\")});var _this$state=_this.state,_this$state$externalE=_this$state.externalEvents,externalEvents=_this$state$externalE===void 0?[]:_this$state$externalE,deleteEventOnDrop=_this$state.deleteEventOnDrop;if(!deleteEventOnDrop)return;_this.setState({externalEvents:externalEvents.filter(function(item){return!item.title.match(title);})});};_this.handleDeleteEvent=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var _yield$deleteEvent,eventList;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(id){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:_context2.next=4;return deleteEvent({id:id});case 4:_yield$deleteEvent=_context2.sent;eventList=_yield$deleteEvent.data;_this.refreshFullCalendar(eventList);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}();_this.toggleEventDialog=function(){_this.setState({eventDialogOpen:!_this.state.eventDialogOpen});};_this.handleEventDialogSubmit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(eventObject){var eventList,_yield$updateEvent2,data,_yield$addNewEvent,_data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:eventList=[];if(!eventObject.id){_context3.next=9;break;}_context3.next=4;return updateEvent(eventObject);case 4:_yield$updateEvent2=_context3.sent;data=_yield$updateEvent2.data;eventList=data;_context3.next=14;break;case 9:_context3.next=11;return addNewEvent(eventObject);case 11:_yield$addNewEvent=_context3.sent;_data=_yield$addNewEvent.data;eventList=_data;case 14:_this.refreshFullCalendar(eventList);case 15:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref4.apply(this,arguments);};}();_this.handleEventClick=function(_ref5){var _ref5$event=_ref5.event,id=_ref5$event.id,start=_ref5$event.start,end=_ref5$event.end,title=_ref5$event.title,allDay=_ref5$event.allDay,classNames=_ref5$event.classNames,backgroundColor=_ref5$event.backgroundColor,extendedProps=_ref5$event.extendedProps;_this.setState({eventDialogOpen:true,eventObject:{id:id,title:title,start:start,end:end,allDay:allDay,classNames:classNames,color:backgroundColor}});};_this.handleChange=function(event){var title=event.target.value;if(event.key===\"Enter\"){title=title.trim();if(title!==\"\"){_this.setState({externalEvents:[].concat(_toConsumableArray(_this.state.externalEvents),[{title:title}]),newEventInput:\"\"});}}else{_this.setState({newEventInput:title});}};_this.refreshFullCalendar=function(){var eventList=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];_this.setState({calendarEvents:eventList.map(function(e){return{start:e.start,title:e.title,id:e.id,end:e.end,classNames:e.classNames,color:e.color,allDay:e.allDay};}),eventDialogOpen:false});};return _this;}_createClass(AppCalendar,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;getAllEvents().then(function(_ref6){var data=_ref6.data;if(_this2.state)_this2.setState({calendarEvents:data});});var draggableEl=this.externalEventRef.current;new Draggable(draggableEl,{itemSelector:\".fc-event\",eventData:function eventData(eventEl){var title=eventEl.innerText;var id=shortid.generate();var classNames=eventEl.classList.value+\" text-white\";// this.handleEventDialogSubmit({\n//   event: { title, classNames, allDay: true }\n// });\nreturn{title:title,id:id,classNames:classNames,create:false};}});}},{key:\"render\",value:function render(){var _this3=this;var _this$state2=this.state,calendarEvents=_this$state2.calendarEvents,calendarWeekends=_this$state2.calendarWeekends,eventDialogOpen=_this$state2.eventDialogOpen,eventObject=_this$state2.eventObject,newEventInput=_this$state2.newEventInput,deleteEventOnDrop=_this$state2.deleteEventOnDrop,_this$state2$external=_this$state2.externalEvents,externalEvents=_this$state2$external===void 0?[]:_this$state2$external;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Breadcrumb,{routeSegments:[{name:\"Home\",path:\"/\"},{name:\"Calendar\"}]}),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card mb-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"create_event_wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"newEvent\"},\" Create new Event\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"newEvent\",className:\"form-control\",placeholder:\"new Event\",value:newEventInput,onChange:this.handleChange,onKeyUp:this.handleChange})),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group\",id:\"external-events\",ref:this.externalEventRef},externalEvents.map(function(event,ind){return/*#__PURE__*/React.createElement(\"li\",{key:ind,style:{backgroundColor:\"#f5f5f5\",color:\"#000000\"},className:\"list-group-item  fc-event\"},event.title);})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{className:\"checkbox checkbox-primary\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",name:\"agree\",value:deleteEventOnDrop,checked:deleteEventOnDrop,onChange:function onChange(e){return _this3.setState({deleteEventOnDrop:e.target.checked});}}),/*#__PURE__*/React.createElement(\"span\",null,\"Remove after drop\"),/*#__PURE__*/React.createElement(\"span\",{className:\"checkmark\"}))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-9\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card mb-4 o-hidden\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(FullCalendar,{defaultView:\"dayGridMonth\",header:{left:\"prev,next today\",center:\"title\",right:\"dayGridMonth,timeGridWeek,timeGridDay,listWeek\"},themeSystem:\"bootstrap\",displayEventTime:false,droppable:true,editable:true,eventLimit:true,plugins:[dayGridPlugin,timeGridPlugin,interactionPlugin],ref:this.calendarComponentRef,weekends:calendarWeekends,events:calendarEvents,dateClick:this.handleDateClick,eventDrop:this.handleEventDrop,eventResize:this.handleEventDrop,eventClick:this.handleEventClick,drop:this.handleExternalEventDrop}))))),/*#__PURE__*/React.createElement(CalendarEventDialog,{open:eventDialogOpen,closeDialog:this.toggleEventDialog,handleSubmit:this.handleEventDialogSubmit,eventObject:eventObject,handleDeleteEvent:this.handleDeleteEvent}));}}]);return AppCalendar;}(Component);export default AppCalendar;","map":{"version":3,"sources":["/Users/arjun/Documents/Personal/Test/Theta/UI Theme/gull-admin/react/src/app/views/app/calendar/AppCalendar.jsx"],"names":["React","Component","Breadcrumb","FullCalendar","dayGridPlugin","timeGridPlugin","interactionPlugin","Draggable","getAllEvents","addNewEvent","updateEvent","deleteEvent","shortid","CalendarEventDialog","AppCalendar","calendarComponentRef","createRef","externalEventRef","state","eventDialogOpen","calendarEvents","eventObject","newEventInput","deleteEventOnDrop","externalEvents","title","toggleWeekends","setState","calendarWeekends","gotoPast","calendarApi","current","getApi","gotoDate","handleDateClick","arg","start","date","allDay","classNames","handleEventDrop","event","id","end","backgroundColor","extendedProps","color","eventList","data","refreshFullCalendar","handleExternalEventDrop","draggedEl","innerText","classList","value","handleEventDialogSubmit","concat","filter","item","match","handleDeleteEvent","toggleEventDialog","handleEventClick","handleChange","target","key","trim","map","e","then","draggableEl","itemSelector","eventData","eventEl","generate","create","name","path","ind","checked","left","center","right"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Breadcrumb } from \"@gull\";\nimport FullCalendar from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport timeGridPlugin from \"@fullcalendar/timegrid\";\nimport interactionPlugin, { Draggable } from \"@fullcalendar/interaction\"; // needed for dayClick\nimport {\n  getAllEvents,\n  addNewEvent,\n  updateEvent,\n  deleteEvent\n} from \"./CalendarService\";\nimport shortid from \"shortid\";\nimport CalendarEventDialog from \"./CalendarEventDialog\";\n\nclass AppCalendar extends Component {\n  calendarComponentRef = React.createRef();\n  externalEventRef = React.createRef();\n\n  state = {\n    eventDialogOpen: false,\n    calendarEvents: [],\n    eventObject: {},\n    newEventInput: \"\",\n    deleteEventOnDrop: false,\n    externalEvents: [\n      { title: \"Hello world\" },\n      { title: \"Payment schedule\" },\n      { title: \"Go to shopping\" },\n      { title: \"Rend due\" },\n      { title: \"Car rent\" }\n    ]\n  };\n\n  toggleWeekends = () => {\n    this.setState({\n      calendarWeekends: !this.state.calendarWeekends\n    });\n  };\n\n  gotoPast = () => {\n    let calendarApi = this.calendarComponentRef.current.getApi();\n    calendarApi.gotoDate(\"2000-01-01\"); // call a method on the Calendar object\n  };\n\n  handleDateClick = arg => {\n    this.setState({\n      eventDialogOpen: true,\n      eventObject: {\n        title: \"\",\n        start: arg.date,\n        allDay: arg.allDay,\n        classNames: [\"text-white\"]\n      }\n    });\n  };\n\n  handleEventDrop = async ({\n    event: {\n      id,\n      start,\n      end,\n      title,\n      allDay,\n      classNames,\n      backgroundColor,\n      extendedProps\n    }\n  }) => {\n    let { data: eventList } = await updateEvent({\n      id,\n      start,\n      end,\n      title,\n      allDay,\n      classNames,\n      color: backgroundColor\n    });\n\n    this.refreshFullCalendar(eventList);\n  };\n\n  handleExternalEventDrop = event => {\n    let {\n      date: start,\n      allDay,\n      draggedEl: {\n        innerText: title,\n        classList: { value: classNames }\n      }\n    } = event;\n\n    this.handleEventDialogSubmit({\n      start,\n      title,\n      allDay,\n      classNames: classNames.concat(\" text-white\")\n    });\n\n    let { externalEvents = [], deleteEventOnDrop } = this.state;\n\n    if (!deleteEventOnDrop) return;\n\n    this.setState({\n      externalEvents: externalEvents.filter(item => !item.title.match(title))\n    });\n  };\n\n  handleDeleteEvent = async id => {\n    if (!id) return;\n    let { data: eventList } = await deleteEvent({ id });\n    this.refreshFullCalendar(eventList);\n  };\n\n  toggleEventDialog = () => {\n    this.setState({ eventDialogOpen: !this.state.eventDialogOpen });\n  };\n\n  handleEventDialogSubmit = async eventObject => {\n    let eventList = [];\n\n    if (eventObject.id) {\n      let { data } = await updateEvent(eventObject);\n      eventList = data;\n    } else {\n      let { data } = await addNewEvent(eventObject);\n      eventList = data;\n    }\n\n    this.refreshFullCalendar(eventList);\n  };\n\n  handleEventClick = ({\n    event: {\n      id,\n      start,\n      end,\n      title,\n      allDay,\n      classNames,\n      backgroundColor,\n      extendedProps\n    }\n  }) => {\n    this.setState({\n      eventDialogOpen: true,\n      eventObject: {\n        id,\n        title,\n        start,\n        end,\n        allDay,\n        classNames,\n        color: backgroundColor\n      }\n    });\n  };\n\n  handleChange = event => {\n    let title = event.target.value;\n    if (event.key === \"Enter\") {\n      title = title.trim();\n      if (title !== \"\") {\n        this.setState({\n          externalEvents: [...this.state.externalEvents, { title }],\n          newEventInput: \"\"\n        });\n      }\n    } else {\n      this.setState({ newEventInput: title });\n    }\n  };\n\n  refreshFullCalendar = (eventList = []) => {\n    this.setState({\n      calendarEvents: eventList.map(e => ({\n        start: e.start,\n        title: e.title,\n        id: e.id,\n        end: e.end,\n        classNames: e.classNames,\n        color: e.color,\n        allDay: e.allDay\n      })),\n      eventDialogOpen: false\n    });\n  };\n\n  componentDidMount() {\n    getAllEvents().then(({ data }) => {\n      if (this.state) this.setState({ calendarEvents: data });\n    });\n\n    let draggableEl = this.externalEventRef.current;\n    new Draggable(draggableEl, {\n      itemSelector: \".fc-event\",\n      eventData: function(eventEl) {\n        let title = eventEl.innerText;\n        let id = shortid.generate();\n        let classNames = eventEl.classList.value + \" text-white\";\n        // this.handleEventDialogSubmit({\n        //   event: { title, classNames, allDay: true }\n        // });\n        return { title, id, classNames, create: false };\n      }\n    });\n  }\n\n  render() {\n    let {\n      calendarEvents,\n      calendarWeekends,\n      eventDialogOpen,\n      eventObject,\n      newEventInput,\n      deleteEventOnDrop,\n      externalEvents = []\n    } = this.state;\n\n    return (\n      <div>\n        <Breadcrumb\n          routeSegments={[{ name: \"Home\", path: \"/\" }, { name: \"Calendar\" }]}\n        ></Breadcrumb>\n\n        <div className=\"row\">\n          <div className=\"col-md-3\">\n            <div className=\"card mb-4\">\n              <div className=\"card-body\">\n                <div className=\"create_event_wrap\">\n                  <div className=\"form-group\">\n                    <label htmlFor=\"newEvent\"> Create new Event</label>\n                    <input\n                      type=\"text\"\n                      name=\"newEvent\"\n                      className=\"form-control\"\n                      placeholder=\"new Event\"\n                      value={newEventInput}\n                      onChange={this.handleChange}\n                      onKeyUp={this.handleChange}\n                    />\n                  </div>\n\n                  <ul\n                    className=\"list-group\"\n                    id=\"external-events\"\n                    ref={this.externalEventRef}\n                  >\n                    {externalEvents.map((event, ind) => (\n                      <li\n                        key={ind}\n                        style={{ backgroundColor: \"#f5f5f5\", color: \"#000000\" }}\n                        className=\"list-group-item  fc-event\"\n                      >\n                        {event.title}\n                      </li>\n                    ))}\n                  </ul>\n                  <p>\n                    <label className=\"checkbox checkbox-primary\">\n                      <input\n                        type=\"checkbox\"\n                        name=\"agree\"\n                        value={deleteEventOnDrop}\n                        checked={deleteEventOnDrop}\n                        onChange={e =>\n                          this.setState({ deleteEventOnDrop: e.target.checked })\n                        }\n                      />\n                      <span>Remove after drop</span>\n                      <span className=\"checkmark\"></span>\n                    </label>\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"col-md-9\">\n            <div className=\"card mb-4 o-hidden\">\n              <div className=\"card-body\">\n                <FullCalendar\n                  defaultView=\"dayGridMonth\"\n                  header={{\n                    left: \"prev,next today\",\n                    center: \"title\",\n                    right: \"dayGridMonth,timeGridWeek,timeGridDay,listWeek\"\n                  }}\n                  themeSystem=\"bootstrap\"\n                  displayEventTime={false}\n                  droppable={true}\n                  editable={true}\n                  eventLimit={true}\n                  plugins={[dayGridPlugin, timeGridPlugin, interactionPlugin]}\n                  ref={this.calendarComponentRef}\n                  weekends={calendarWeekends}\n                  events={calendarEvents}\n                  dateClick={this.handleDateClick}\n                  eventDrop={this.handleEventDrop}\n                  eventResize={this.handleEventDrop}\n                  eventClick={this.handleEventClick}\n                  drop={this.handleExternalEventDrop}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        <CalendarEventDialog\n          open={eventDialogOpen}\n          closeDialog={this.toggleEventDialog}\n          handleSubmit={this.handleEventDialogSubmit}\n          eventObject={eventObject}\n          handleDeleteEvent={this.handleDeleteEvent}\n        ></CalendarEventDialog>\n      </div>\n    );\n  }\n}\n\nexport default AppCalendar;\n"]},"metadata":{},"sourceType":"module"}